{"ast":null,"code":"var _jsxFileName = \"/home/hyogun/\\uBC14\\uD0D5\\uD654\\uBA74/dumbo/frontend/src/components/ScrollTest.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport { FixedSizeList as List } from \"react-window\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ITEM_HEIGHT = 150;\nconst BUFFER = 40;\nconst ScrollTest = () => {\n  _s();\n  const [posts, setPosts] = useState(new Map());\n  const [visibleIndexes, setVisibleIndexes] = useState({\n    start: 0,\n    stop: 0\n  });\n  const listRef = useRef(null);\n  const fetchPost = async index => {\n    try {\n      const res = await axios.get(`/api/posts/${index}`);\n      return res.data;\n    } catch (e) {\n      console.error(\"Fetch failed\", e);\n      return null;\n    }\n  };\n  const loadAround = useCallback(async (startIndex, stopIndex) => {\n    const newPosts = new Map(posts);\n    for (let i = startIndex; i <= stopIndex; i++) {\n      if (!posts.has(i)) {\n        const post = await fetchPost(i);\n        if (post) newPosts.set(i, post);\n      }\n    }\n    const min = Math.max(0, startIndex - BUFFER);\n    const max = stopIndex + BUFFER;\n    for (let key of newPosts.keys()) {\n      if (key < min || key > max) {\n        newPosts.delete(key);\n      }\n    }\n    setPosts(new Map(newPosts));\n  }, [posts]);\n  useEffect(() => {\n    loadAround(visibleIndexes.start, visibleIndexes.stop);\n  }, [visibleIndexes, loadAround]);\n  const Row = ({\n    index,\n    style\n  }) => {\n    const post = posts.get(index);\n    if (!post) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: style,\n        children: \"\\uB85C\\uB529 \\uC911...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 14\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        ...style,\n        padding: 10,\n        borderBottom: \"1px solid #ccc\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: post.previewText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(List, {\n    height: 600,\n    itemCount: 10000,\n    itemSize: ITEM_HEIGHT,\n    width: \"100%\",\n    ref: listRef,\n    onItemsRendered: ({\n      visibleStartIndex,\n      visibleStopIndex\n    }) => {\n      setVisibleIndexes({\n        start: visibleStartIndex,\n        stop: visibleStopIndex\n      });\n    },\n    children: Row\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n_s(ScrollTest, \"HOYkOvMQzWFcNWX6XUbblqGJTu0=\");\n_c = ScrollTest;\nexport default ScrollTest;\nvar _c;\n$RefreshReg$(_c, \"ScrollTest\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","FixedSizeList","List","axios","jsxDEV","_jsxDEV","ITEM_HEIGHT","BUFFER","ScrollTest","_s","posts","setPosts","Map","visibleIndexes","setVisibleIndexes","start","stop","listRef","fetchPost","index","res","get","data","e","console","error","loadAround","startIndex","stopIndex","newPosts","i","has","post","set","min","Math","max","key","keys","delete","Row","style","children","fileName","_jsxFileName","lineNumber","columnNumber","padding","borderBottom","title","previewText","height","itemCount","itemSize","width","ref","onItemsRendered","visibleStartIndex","visibleStopIndex","_c","$RefreshReg$"],"sources":["/home/hyogun/바탕화면/dumbo/frontend/src/components/ScrollTest.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport { FixedSizeList as List } from \"react-window\";\nimport axios from \"axios\";\n\nconst ITEM_HEIGHT = 150;\nconst BUFFER = 40;\n\nconst ScrollTest = () => {\n  const [posts, setPosts] = useState(new Map());\n  const [visibleIndexes, setVisibleIndexes] = useState({ start: 0, stop: 0 });\n  const listRef = useRef(null);\n\n  const fetchPost = async (index) => {\n    try {\n      const res = await axios.get(`/api/posts/${index}`);\n      return res.data;\n    } catch (e) {\n      console.error(\"Fetch failed\", e);\n      return null;\n    }\n  };\n\n  const loadAround = useCallback(async (startIndex, stopIndex) => {\n    const newPosts = new Map(posts);\n\n    for (let i = startIndex; i <= stopIndex; i++) {\n      if (!posts.has(i)) {\n        const post = await fetchPost(i);\n        if (post) newPosts.set(i, post);\n      }\n    }\n\n    const min = Math.max(0, startIndex - BUFFER);\n    const max = stopIndex + BUFFER;\n\n    for (let key of newPosts.keys()) {\n      if (key < min || key > max) {\n        newPosts.delete(key);\n      }\n    }\n\n    setPosts(new Map(newPosts));\n  }, [posts]);\n\n  useEffect(() => {\n    loadAround(visibleIndexes.start, visibleIndexes.stop);\n  }, [visibleIndexes, loadAround]);\n\n  const Row = ({ index, style }) => {\n    const post = posts.get(index);\n\n    if (!post) {\n      return <div style={style}>로딩 중...</div>;\n    }\n\n    return (\n      <div style={{ ...style, padding: 10, borderBottom: \"1px solid #ccc\" }}>\n        <h3>{post.title}</h3>\n        <p>{post.previewText}</p>\n      </div>\n    );\n  };\n\n  return (\n    <List\n      height={600}\n      itemCount={10000}\n      itemSize={ITEM_HEIGHT}\n      width=\"100%\"\n      ref={listRef}\n      onItemsRendered={({ visibleStartIndex, visibleStopIndex }) => {\n        setVisibleIndexes({ start: visibleStartIndex, stop: visibleStopIndex });\n      }}\n    >\n      {Row}\n    </List>\n  );\n};\n\nexport default ScrollTest;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}